---
title:  'Beauty in the Ear of the Beholder '
output: 
    flexdashboard::flex_dashboard:
        css: mytheme_experimental.css
        vertical_layout: scroll
        orientation: rows
---

```{r setup}
# In order to use these packages, we need to install flexdashboard, plotly, and Cairo (and dlexdashboard & DiagrammeR).
library(tidyverse)
library(plotly)
library(spotifyr)
library(Cairo)
library(gridExtra)
library(grid)
library(gtable)
library(ggplot2)
library(compmus)
library(viridis)
library(DT)
library(ggiraph)
library(flexdashboard)
library (DiagrammeR)
source('spotify.R')

library(scales)


Theme_experimental <- theme(plot.background = element_rect(fill = "#2c5c8b", colour = "#2c5c8b"), text = element_text(colour = "white"), axis.text = element_text(colour = "white"))

```

Intro
====================================


Topic {.sidebar data-width=420}
-------------------------------------
### **Assessing the Beauty of Music**  {.no-padding}
  Music is valued by people for many various reasons, be it the emotion it generates, the memories it triggers, or the beauty it transcends. Nevertheless, this perception of aesthetics is highly subjective. There is no specific reason or explanation to why one would prefer jazz over pop music. However, this realisation has not stopped scholars and academics from generating theories that objectify aesthetics. 
  
  The modernist view of music aesthetics (<a href="https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5096663/ target="_blank"">Huang et al., 2016</a>) supports the idea of genre hierarchy. This theory states that complex music, such as jazz, is less popularly valued because of its high intellectual demand. Followers of the theory would explain the above-mentioned example by arguing that jazz is a genre that can be comprehended and appreciated only by musically sophisticated individuals.
  
  Furthermore, jazz might be not as popular as pop, for instance, because popularity requires accessibility. With these ongoing debates in the arena, we wanted to test if there is an objective quality to beauty. This led us to our research question: **"To what extent does musical sophistication influence the perception of beauty?"**


Column
-------------------------------------

### Selected songs  {.no-padding}
```{r}
valueBox (15, icon ="ion-music-note", color = "primary")
```

### Experts curated our playlist {.no-padding}
```{r}
valueBox (3, icon ="ion-ios-people", color = "success")
```

### Participants  {.no-padding}
```{r}
valueBox (119, icon ="ion-location", color = "info")
```

### LCA classes  {.no-padding}
```{r}
valueBox (3, icon ="ion-levels",color = "#2eb8b8")
```

Column
------------------------------------

### Our Research
Listen to this short music snippet:

<audio controls>
  <source src="Married Life.mp3" type="audio/mpeg">
</audio>  <br>

Do you find this snippet beautiful? Are you familiar with the song? Do you think this song fits with your overall genre preferences?

We are curious to know what factors influenced the perception of beauty the most. After listening to the song, could you estimate what are those factors? This question is at the heart of our research. Click through the website to check if your predictions are accurate!


Exploring Beauty through different characteristics{data-navmenu="Main Research" data-orientation=columns} 
============================================================================================================

Column {.tabset}
-------------------------------------


### Procedure
To compile suitable stimuli, <a href="https://aesthetics-beauty.github.io/Portfolio/#compiling-the-playlist" target="_blank">a pre-test was conducted</a>. After choosing 15 stimuli snippets, we created a <a href="https://www.qualtrics.com/" target="_blank">Qualtrics</a> survey. Firstly, participants had to answer basic background questions, namely age, gender and country of origin. Afterwards, they were presented with a short version of <a href="https://www.gold.ac.uk/music-mind-brain/gold-msi/" target="_blank">Gold-MSI</a> test. Then, participants were presented with the 15 songs in a random order. They had to choose whether they found the snippet beautiful or not. Additionally, they were asked if they were familiar with the snippet. Participants could listen to the song as many times as they like. Finally, they had to choose three favorite genres based on a <a href="https://gosling.psy.utexas.edu/scales-weve-developed/short-test-of-music-preferences-stomp/" target="_blank">STOMP</a> selection. All in all, we collected the data from 119 participants.

Such procedure helps to divide people into classes by their musical preferences, and then check whether there are any significant changes in characteristics per class. 

***
<b>Characteristics of the Sample</b>

In this section, we will analyse the graphs to determine the characteristics of our sample. 

Before we begin with the analysis, we would like to mention that our data might be a bit biased, as our participants are predominantly females that are in their 20s. 


### Nationality
Click on the tab <i>Nationality</i> on the right to see the graph

As you can see from the graph, the majority of our participants are from The Netherlands. Nevertheless, we are proud to mention that we gathered a diverse group of participants. The respondents come from 26 different countries from all over the world: Asia, Africa, Europe and America. The majority of our participants are either European or Asian. 

### Genre Preference
Click on the tab <i>Genre Preferences</i> on the right to see the graph

To assess genre preferences, we asked participants to rank three of their best preferred genres. The majority of our sample favours pop music. This might be due to the fact that our participants are predominantly in their 20s. Tied in the second place are classical and rock genres. Bluegrass proved to be the least favourite genre. One feasible explanation is that bluegrass is overall less common than the other genres, thus unfamiliar to the majority of participants.

### STOMP
Click on the tab <i>STOMP</i> on the right to see the graph
 
The Short Test of Music Preference (STOMP) is designed to assess music preferences that are related to personality variables, self-views and cognitive abilities. The test consists of 4 categories:

1.	Reflective & Complex: classical, blues, folk, jazz, etc.

2.	Intense & Rebellious: alternative, rock, heavy metal, punk, etc.

3.	Upbeat & Conventional: country, religious, pop, soundtracks, etc. 

4.	Energetic & Rhythmic: electronica, rap, soul, funk, etc.

The genre preferences were divided according to these groups.

As can be seen, Upbeat & Conventional category is the most liked. Genres from Energetic & Rhythmic category are least preferred by the participants.

### Musical Sophistication and Genre Preference

Click on the tab <i>Musical Sophistication and Genre Preference</i> on the right to see the graph

To test individual differences in musical sophistication, we used the short version of Goldsmiths Musical Sophistication Index (Gold-MSI). The following 5 aspects are measured using a self-report questionnaire:

1.	active musical engagement: the amount of time and resources spent on music;

2.	self-reported perceptual abilities: the accuracy of musical listening skills;

3.	musical training: the amount of formal musical training received;

4.	self-reported singing abilities: the accuracy of singing;

5.	sophisticated emotional engagement with music: the ability to talk about the emotions that music expresses.

According to the test, the higher the overall score is (on a scale from 18 to 125), the more musically sophisticated the person is. To see if musical sophistication affects genre preferences, we looked at the distribution of the Gold-MSI scores in STOMP groups. 

From the graph, we can infer that all 4 categories have pretty similar median scores. Unsurprisingly, the highest Gold-MSI median is in Reflective & Complex category. In fact, the differences between categories are not significant. Hence, we can conclude that musical sophistication does not have much effect on genre preferences. 






Column {.tabset}
----------------------------------------------------




### Nationalities

```{r}
nation= read.csv("COUNTRY OF ORIGIN (+TEXT VALUES).csv", sep=";")

ggplot(nation, aes(x= COUNTRY)) + geom_bar(fill= aes("#004C99", "#0066CC", "#0080FF", "#3399FF", "#66B2FF", "#99CCFF", "#CCE5FF", "#CCCCFF", "#9999FF", 
"#6666FF", "#3333FF", "#0000FF", "#0000CC", "#000066", "#000099", "#0000CC", "#0000FF", "#3333FF", "#9999FF","#CCCCFF", "#E5CCFF", "#CC99FF", "#B266FF", "#9933FF", "#7F00FF", "#6600CC")) + theme(text = element_text(),axis.text.x = element_text(size=8, angle = 45, hjust = 1)) + ggtitle("nationality of participants") +ylab("number of participants") + Theme_experimental + xlab("Country of origin") + theme(panel.grid.major.x = element_blank(), panel.background = element_rect(fill = "#CCE5FF"))



```



### Genre Preferences

```{r}
genre = read.csv("GENRE STOMP.csv", sep=";")
ggplot(genre, aes(x=genre.preference))+ geom_bar(fill= aes("#0066CC", "#0080FF", "#3399FF","#66B2FF", "#99CCFF", "#CCE5FF", "#CCCCFF", "#9999FF", "#6666FF", "#3333FF", "#0000FF", "#0000CC", "#000099", "#0000CC", "#0000FF", "#3333FF", "#9999FF","#CCCCFF", "#E5CCFF", "#CC99FF", "#B266FF", "#9933FF", "#7F00FF", "#6600CC") ) + theme(text = element_text(), axis.text.x = element_text(size=8, angle = 45, hjust = 1)) + ggtitle("genre preferences") + ylab("number of times genre mentioned in preferences") + Theme_experimental + ylab("Count") + xlab("Genre preference") + theme(panel.grid.major.x = element_blank(), panel.background = element_rect(fill = "#CCE5FF"))

```

### STOMP
```{r}
STOMP<- subset(genre, STOMP1!= "#N/B")
ggplot(STOMP, aes(x=STOMP1))+ geom_bar(fill= aes("#0066CC", "#0080FF","#3399FF","#66B2FF") ) + theme(text = element_text(),  axis.text.x = element_text(size=8, angle = 45, hjust = 1)) + ggtitle("Genre preferences grouped by STOMP") + ylab("number of genre preferences") + xlab("STOMP groups")+
  Theme_experimental+ theme(panel.grid.major.x = element_blank(), panel.background = element_rect(fill = "#CCE5FF"))
```

### Musical Sophistication and Genre Preference
```{r}
STOMP<- subset(genre, STOMP1!= "#N/B")
ggplot(STOMP, aes(x=STOMP1, y=GOLD.MSI.SCORE)) + geom_violin(show.legend = FALSE)+ xlab("STOMP groups") + ylab("Gold Smith MSI score")+ 
  ggtitle("Distribution of Gold Smith MSI scores in STOMP groups")+ stat_summary(fun.data="mean_sdl", geom="pointrange", color="blue",show.legend = FALSE)+
  theme(text = element_text(),axis.text.x = element_text(size=8, angle = 45, hjust = 1))+
  Theme_experimental + theme(panel.grid.major.x = element_blank(), panel.background = element_rect(fill = "#CCE5FF"))

```


Background Information
==================================================================
Row
--------------------------------

### Musical Sophistication and Beauty

The majority of people would agree that perception of beauty, especially in music, is a highly
subjective phenomenon. Or is it? In our research, we aim to explore the relationship between beauty
assessment and musical sophistication.

Previous research done on aesthetics and music mainly focusses on personality traits and how those
influence perception. For instance, awe is one of the profound aesthetic experiences, often described
as being touched, moved, fascinated and amazed. It was found that people who are more open to
experience are more susceptible to awe-like states (<a
href="https://www.researchgate.net/profile/Roger_Beaty/publication/280112363_Openness_to_Expe
rience_and_Awe_in_Response_to_Nature_and_Music_Personality_and_Profound_Aesthetic_Experi
ences/links/55ae399808aed9b7dcdc845d/Openness-to-Experience-and-Awe-in-Response-to-Nature-
and-Music-Personality-and-Profound-Aesthetic-Experiences.pdf" target="_blank">Silvia et al., 2015</a>).
Interestingly, the study was conducted in 2 domains, that is visual and auditory stimuli were used.
Across both domains, openness to experience was the only factor predictive of the higher experience
of awe. One of the drawbacks of the methodology is that judgements were made by listening to only
one song (<a href="https://www.youtube.com/watch?v=hnAwPeqrdAk" target="_blank">'Hoppípolla' by Sigur
Rós</a>). Furthermore, although none of the participants understood the Icelandic language, the
overall perceived 'melodicity', familiarity, etc. of the language could have affected the perception of
the song (<a href="https://www.theguardian.com/education/2014/jul/17/what-makes-a-language-
attractive" target="_blank">Jenkin, 2014</a>). In the present study, we use only instrumental music to control for the
language factor. Furthermore, 15 music snippets were chosen as stimuli.

Usually, listening to music is an aesthetic experience that requires activation of not only affective,
but also cognitive and evaluative processes. Studies have found that music expertise modulates the
cortical processing of different aspects of music perception (e.g. <a
href="http://learnmem.cshlp.org/content/9/3/138.full.pdf" target="_blank">Atienza et al., 2002</a>; <a
href="https://academic.oup.com/cercor/article/14/10/1088/275703" target="_blank">Bosnyak al., 2004</a>).
Cognitive researchers (<a
href="https://www.sciencedirect.com/science/article/abs/pii/S0167876010000334" target="_blank">Müller et al.,
2010</a>) compared aesthetic judgements between experts and laypersons by using event-related
potential (ERP) measurements. They found that when exposed to the same stimuli, experts' and
laypersons' ERP measures systematically differed. We believe that if there is a difference in aesthetic
judgements between groups of experts and laypersons on the 'brain' level, then there should be an
observable distinction on a more conscious level, too. As in <a
href="https://www.sciencedirect.com/science/article/abs/pii/S0167876010000334" target="_blank">Müller's
paper</a>, the question of whether the piece is beautiful or not, as opposed to 'do you like it', used in
the majority of previous papers (e.g. <a
href="https://www.ncbi.nlm.nih.gov/pubmed/19673799" target="_blank">Brattico & Jacobsen, 2009</a>) will be
used to quantify beauty assessment. In this way, the question becomes more linguistically sound and
precise.

Sophistication is not the only factor that could potentially influence beauty perception. Genre
preference might also have a profound impact on whether the participant finds a piece beautiful or
not (<a href="https://www.sciencedirect.com/science/article/pii/S0301051112002505" target="_blank">Istók et al.,
2013</a>). The modernist view of music aesthetics (<a
href="https://journals.sagepub.com/doi/abs/10.2466/pms.1990.71.2.687" target="_blank">Burke & Gridley,
1990</a>) supports the idea of genre hierarchy. This theory states that complex music, such as jazz,
is less popularly valued because of its high intellectual demand. Followers of the theory would argue
that jazz is a genre that can be comprehended and appreciated only by musically sophisticated
individuals. For this reason, our stimuli includes a variety of genres, for instance jazz (Drama in Six Notes <audio id="myAudio"><source src="Šešių Natų Drama _ Drama In Six Notes.mp3" type="audio/mpeg"></audio><button onclick="playAudiox()" type="button">&nbsp;▶&nbsp;</button>&nbsp;<button onclick="pauseAudiox()" type="button">&nbsp;❚❚&nbsp;</button>)  bluegrass (Less is Moi <audio id="myAudio2"><source src="Less Is Moi.mp3" type="audio/mpeg"></audio><button onclick="playAudioy()" type="button"> &nbsp;▶&nbsp;</button>&nbsp;<button onclick="pauseAudioy()" type="button">&nbsp;❚❚&nbsp;</button>) and electronic (syro u473t8+e [141.98] <audio id="myAudio3"><source src="syro u473t8+e [141.98] (piezoluminescence mix).mp3" type="audio/mpeg"></audio><button onclick="playAudioz()" type="button">&nbsp;▶&nbsp;</button>&nbsp;<button onclick="pauseAudioz()" type="button">&nbsp;❚❚&nbsp;</button>). In addition, we will check if certain genre preferences correspond with higher musical sophistication scores.

<script>
var x = document.getElementById("myAudio"); 

function playAudiox() { 
  x.play();
  y.pause();
  z.pause();
  y.currentTime = 0;
  z.currentTime = 0; 
} 

function pauseAudiox() { 
  x.pause();
  y.pause();
  z.pause();
  x.currentTime = 0;
  y.currentTime = 0;
  z.currentTime = 0; 
} 
</script>

<script>
var y = document.getElementById("myAudio2"); 

function playAudioy() { 
  y.play();
  x.pause();
  x.currentTime = 0;
  z.currentTime = 0; 
  z.pause();
} 

function pauseAudioy() { 
  x.pause();
  y.pause();
  z.pause();
  x.currentTime = 0;
  y.currentTime = 0;
  z.currentTime = 0; 
} 
</script>

<script>
var z = document.getElementById("myAudio3"); 

function playAudioz() { 
  z.play(); 
  x.pause();
  y.pause()
  x.currentTime = 0;
  y.currentTime = 0;
} 

function pauseAudioz() { 
  x.pause();
  y.pause();
  z.pause();
  x.currentTime = 0;
  y.currentTime = 0;
  z.currentTime = 0;
} 
</script>
Inspired by the aforementioned literature and also personal experiences, we would like to see if
musical sophistication influences the perception of beauty. We hypothesize that higher scores for
music sophistication will align with higher scores for beauty. Furthermore, we will analyze the
potential correlation between said scores and genre preference.

### Article Review: Are musicians particularly sensitive to music?

In the article "Are Musicians Particularly Sensitive to Beauty and Goodness" (<a href="https://www.zora.uzh.ch/id/eprint/88127/" target="_blank"> Güsewell & Ruch, 2014</a>) the degree and form of musical practice of participants is compared to responsiveness to artistic, natural and non-aesthetic beauty and goodness. This was examined using self-report and stimulus-based instruments.

It was found that professional musicians had the highest scores in responsiveness to artistic beauty, experience seeking, and absorption compared to the other groups. The amateur musicians scored highest on overall responsiveness, responsiveness to non-aesthetic goodness and responsiveness to nature. This supports the hypothesis that there is a link between sensitivity to beauty, goodness and musical practice.

From the data, researchers concluded that the responsiveness to beauty was related to the degree of involvement in musical practice. It was suggested that the opportunity to artistically express oneself was needed for a balanced responsiveness to the beauty profile. The groups that scored highest in responsiveness to beauty were believed to have more opportunities to express themselves (amateurs and soloists) or take part in musical activities where strong expressive and artistic involvement was needed (high-level orchestra musicians). 

However, the participants were not grouped based on the opportunity for expression through music. Thus, based on the results of soloists and amateur musicians it is not yet possible to conclude that personal interpretation of music increases responsiveness to beauty. In our study, we focus on the musical sophistication of a larger sample, including participants with both low and high scores. Such a sample might provide a more in-depth look at the relationship between musical experience and perception of beauty. 


***

<b>Contact Information</b> <br>

This research project was conducted as a part of an Honours "The Data Science of Everyday Music Listening" course at the University of Amsterdam (coordinated by dhr. dr. John Ashley Burgoyne).

Research team members:
Xiaoqing Li 
Esther Liefting
Willem Pleiter
Denise Quek
Nikita van 't Rood
Kristina Savickaja

If you have any questions or comments, please contact us at music.beauty.aesthetics@gmail.com

Compiling the Playlist {data-navmenu="Playlist"}
=========================================
 
Column
-------------------------------------
### Rating the Songs
To create the stimuli, we searched online for known datasets that include musical pieces that were dissected according to their musical components. Since the search yielded no results, each member of the group supplied 5 instrumental songs that they found beautiful via Spotify. The chosen songs had to be instrumental to control for the influence of language. Afterwards, the compiled songs were evaluated by 3 musical experts (10+ years of formal musical training). Experts had to rate 30 second songs snippets on a 10-point Likert scale on the following criteria:

- <i>Tempo</i>: the general pulse of the song, very slow (1) - very fast (10)

- <i>Articulation</i>: the rhythmic articulation of the song, very staccato (1) - completely legato (10)

- <i>Mode</i>: overall mode and feel of the song, minor (1) - major (10)

- <i>Intensity</i>: overall loudness, crescendos and decrescendos in a song, pianissimo (1) - fortissimo (10)

- <i>Tonalness</i>: overall tonalness of the composition, very atonal (1) - very tonal (10)

- <i>Pitch</i>: overall distribution of the pitch, all bass (1) - all treble (10)

- <i>Melody</i>: overall presence and dominance of melody, very unmelodious (1) - very melodious (10)

- <i>Rhythmic Clarity</i>: overall presence of a pulse, very vague (1) - very firm (10)

- <i>Rhythmic Complexity</i>: the extent to which different meters, odd tempo or complex rhythmic patterns are utilized, very simple (1) - very complex (10)


This method is based on the evaluation system used by Aljanaki et al. (<a href="https://www.researchgate.net/publication/267326664_COMPUTATIONAL_MODELING_OF_INDUCED_EMOTION_USING_GEMS" target="_blank">2016</a>). The final selection of 15 stimuli songs was chosen based on **A) Feature Representability** and **B) Reliability**.


***
<b>A) Feature Representability </b><br>
<i>The panel on the right is interactive, hover over a point with your mouse to find out more </i>

The combined box and jitterplot shows the overall distribution of the characteristics of the songs. While the boxplot represents the feature values of all 30 songs, the jitterplot illustrates the feature values of the 15 chosen stimuli songs. 

As can be seen from the jitterplot, our final selection covers quite a large range for most parameters.



### Expert Rating per Song

```{r figure.height=20}

#getting features for all songs
Features30 <- read.csv2("Features30.csv")
Features_wide <- Features30 %>%
  gather("Tempo", "Articulation", "Mode", "Intensity", "Tonalness", "Pitch", "Melody", "Rhytmic.Clarity", "Rhythmic.Complexity", key = Feature, value = Parameter)


#getting features for selection
Features15 <- read.csv("Features_goed.csv", sep=";")

Features15_wide <- Features15 %>%
  gather("Tempo", "Articulation", "Mode", "Intensity", "Tonalness", "Pitch", "Melody", "Rhytmic.Clarity", "Rhythmic.Complexity", key = Feature, value = Parameter)

df <- Features15_wide

df$tooltip <- c(paste0("Song = ", df$Song, "\n Feature = ", df$Feature, "\n Parameter = ", df$Parameter))

Features_wide$Cols <- Features_wide$Feature

Features15_wide$Cols <- Features15_wide$Feature



Features_wide$Feature <- factor(Features_wide$Feature, levels = c("Melody", "Tonalness", "Articulation", "Intensity", "Pitch", "Rhytmic.Clarity", "Tempo", "Rhythmic.Complexity", "Mode"))


tooltip_css <- "background-color:#9ccdff;opacity:0.2;font-size:15px;border-radius:10px;padding:10px;font-family:'Roboto','Helvetica Neue',Helvetica,Arial,sans-serif;color: #040404"

Box_jitter <- ggplot(Features_wide, aes(x = Feature, y = Parameter, col = Cols, label = Song)) +
  geom_boxplot(show.legend = FALSE, alpha = 0.4, outlier.shape = NA) +
    theme(text = element_text(),
        axis.text.x = element_text(size=7, angle = 45, hjust = 1)) +
    geom_jitter_interactive(data = Features15_wide, width = 0.25, alpha = 0.7, aes(colour = Cols, tooltip= df$tooltip, data_id = Song), show.legend = FALSE) +
    theme(axis.text.x = element_text(size=7, angle = 45, hjust = 1)) +
  scale_y_continuous(limits = c(0, 10), breaks = seq(0,10, by = 1)) +
  scale_x_discrete(labels = labs)  +
  theme(legend.position='none') + Theme_experimental + theme(panel.grid.major.x = element_blank(), panel.background = element_rect(fill = "#CCE5FF"))


ggiraph(ggobj = Box_jitter, hover_css = "stroke:darkgrey;r:3pt;fill-opacity:1", tooltip_extra_css = tooltip_css)




#ggplotly(p = Box_jitter, width = NULL, height = NULL, tooltip = c("Song", "Parameter", "Feature"), dynamicTicks = FALSE, layerData = 1, originalData = TRUE, source = "A")






```

Column
-------------------------------------

### Reliability
To finalize our selection of stimuli songs, we first estimated the reliability of the expert ratings per song. To do this, the distance scores between each of the expert‘s evaluation was computed. For example, each evaluator rated a song on Tempo. If the first rater gave it a 5, the second rater gave it a 6 and the third - 7, the distance is then calculated by taking the distance between the first and the second rater (6 - 5 = 1); the second and the third rater (7 - 6 = 1) and the distance between the first and the third rater (7 - 5 = 2). The sum of the differences (1 + 1 + 2 = 4) provides an estimate of a consensus for Tempo. Subsequently, this process was repeated for all components per song. Then, all reliability scores per component were summed to give an estimate of overall reliability. The table on the right shows these scores for all 30 songs.

As can be seen from the table, the reliability scores range between 26 and 64, with a lower score representing stronger consensus. Based on these scores, we estimated a cut-off point of < 45 and selected the final stimuli.

However, upon examining our prior selection, it became apparent that the distribution of melody ratings was skewed in favour of very melodious songs. Furthermore, there was a lack of atonal songs. To tackle these issues, we decided to discard The Kiss (reliability score of 42) and add Drama In Six Notes (reliability score of 46) instead.



### Reliability Scores per Song
```{r}
Rela <- read.csv("Reliability.csv", sep=";")

datatable(Rela,
  rownames = FALSE, options = list(pageLength = 10)
)
```





Songs {data-navmenu="Playlist"}
========================================

Row
-------------------------------------

###  Snippets 

Blueming<br>
<audio controls>
  <source src="Blueming.mp3" type="audio/mpeg"> 
</audio> <br>


Bygone Bumps <br>
<audio controls>
  <source src="Bygone Bumps.mp3" type="audio/mpeg">
</audio>  <br>


Cia Pat <br>
<audio controls>
  <source src="Cia Pat.mp3" type="audio/mpeg">
</audio>  <br>

Decision (Price of Love)<br>
<audio controls>
  <source src="Decision (Price of Love).mp3" type="audio/mpeg"> 
</audio> <br>


Elysium <br>
<audio controls>
  <source src="Elysium.mp3" type="audio/mpeg">
</audio>  <br>



Firth Of Fifth <br>
<audio controls>
  <source src="Firth Of Fifth.mp3" type="audio/mpeg">
</audio>  <br>

Less Is Moi <br>
<audio controls>
  <source src="Less Is Moi.mp3" type="audio/mpeg">
</audio>  <br>

Married Life <br>
<audio controls>
  <source src="Married Life.mp3" type="audio/mpeg">
</audio>  <br>

Resolver <br>
<audio controls>
  <source src="Resolver.mp3" type="audio/mpeg">
</audio>  <br>

Scarface Theme <br>
<audio controls>
  <source src="ScarFace 'Tony Theme' Giorgio Moroder.mp3" type="audio/mpeg">
</audio>  <br>


Single Petal Of A Rose <br>
<audio controls>
  <source src="Single Petal Of A Rose.mp3" type="audio/mpeg">
</audio>  <br>

Song For A New Beginning <br>
<audio controls>
  <source src="Song For A New Beginning.mp3" type="audio/mpeg">
</audio>  <br>

syro u473t8+e <br>
<audio controls>
  <source src="syro u473t8+e [141.98] (piezoluminescence mix).mp3" type="audio/mpeg">
</audio>  <br>

Šešių Natų Drama (Drama In Six Notes) <br>
<audio controls>
  <source src="Šešių Natų Drama _ Drama In Six Notes.mp3" type="audio/mpeg">
</audio>  <br>

USA III Rail <br>
<audio controls>
  <source src="USA III Rail.mp3" type="audio/mpeg">
</audio>  <br>

### Full Songs

<iframe src="https://open.spotify.com/embed/playlist/10OqKYDJG7e4fEBZDCzcvw" width="300" height="800" frameborder="0" allowtransparency="true" allow="encrypted-media"></iframe>




Splitting the Sample {data-navmenu="Main Research" data-orientation=columns}
===============================================================================
  
  
Column
------------------------------------------------------------
  
### The LCA
Latent Class Analysis (LCA) is a psychometric method in which participants are grouped based on how likely they would respond positive to a certain survey item. In our case, the said item is the song snippet that the participant find beautiful or not.

After running the data from 119 participants through the LCA, only a 3-class model fitted the data appropriately (refer to the ' LCA Class Table '). The table shows the probability of a person belonging to a particular class based on their beauty judgement (yes/no) of a specific snippet. For instance, for USA III RAIL, a person belonging to 'Likers' group has a 72% chance of rating the song beautiful, 'Indifferents' - 49% and 'Dislikers' - 0%. These conditional probabilities are available for all classes, so you can hover over the table to see which songs were generally very liked and which were disliked.

As you may have figured out, the names of classes correspond with the quantity of songs that they find beautiful. Thus, 'Likers' find the majority of snippets beautiful, 'Indifferents' are the middle group and 'Dislikers' find most of the songs not beautiful. 'Likers' comprised 38% of our sample, 'Indifferents' - 48% and 'Dislikers' - 14%.


***

<b>ANOVA</b> <br>
On the second tab, the post-hoc and ANOVA are shown. 

In our analysis, ANOVA is a method in which means and variance between classes are compared to see whether the differences in Gold-MSI scores are significant. To find out which particular classes differ from each other, a Tukey's test was performed. The test compares the groups one by one, instead of all at once like ANOVA does.

On x-axis, the size of the difference between groups (illustrated on y-axes) can be seen. The visible intervals are 95% confidence intervals - the intervals that in 95% of the cases will contain the "true" difference in Gold-MSI score. 

To illustrate the Tukey's test further, since the red lines do not contain a value of 0, we can confidently say that if we were to repeat the experiment an infinite amount of times, that in 95% of the time they will contain the "true" difference. That allows us to refute the idea that these groups do not differ in Gold-MSI scores.

In conclusion, the plot shows evidence that the 'Likers' tend to have higher musical sophistication scores than both 'Dislikers' and 'Indifferents'. There is no difference between 'Dislikers' and 'Indifferents'. These results confirm our hypothesis that higher Gold-MSI score will correspond with a higher number of  "yes, I find this song beautiful" answers. 

<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>
<br>



  
Column {.tabset}
--------------------------------------------------
### LCA class table
```{r}
Beauty_wide <- read.csv("D:/STUDIE/PSYCH/JAAR 3/HONOURS MUSICOLOGY/Portfolio/Beauty_wide.csv")
Beauty_wide$Class <- factor(Beauty_wide$Class, levels = c("Likers", "Indifferents", "Dislikers"))
Beauty_wide$song <- factor(Beauty_wide$song, levels = c("SYRO", "DRAMA IN SIX NOTES", "CIA PAT", "RESOLVER", "USA III RAIL","SCARFACE", "Elysium", "LESS IS MOI", "FIRTH OF FIFTH", "SINGLE PETAL OF A ROSE", "BYGONE BUMPS", "DECISION", "SONG FOR A NEW BEGINNING", "BLUEMING", "MARRIED LIFE"))

colnames(Beauty_wide) <- c(colnames(Beauty_wide)[1:3], "Probability")

Beauty_wide$percent <- percent(Beauty_wide$Probability)

LCA_table <- ggplot(Beauty_wide, aes(x = Class, y = song, fill = Probability, colour = "grey50")) +
  geom_tile_interactive(colour = "darkgrey", aes(tooltip = percent)) + theme_minimal() + scale_x_discrete(position = "top") + scale_fill_gradient(
    low = "#efedf5",
    high = "#40217d",
    space = "Lab",
    na.value = "grey50",
    guide = "colourbar",
    aesthetics = "fill") + Theme_experimental + theme(axis.ticks.x = element_blank(), axis.ticks.y  =  element_blank(), axis.text = element_text(size = 7))


ggiraph(ggobj = LCA_table, hover_css = "stroke:darkgrey;r:3pt;fill-opacity:1", tooltip_extra_css = tooltip_css, width = 0.8, height = 4)




```

### ANOVA Post-Hoc Results

```{r}
tky <- readRDS(file = "tky.rds")
ggplot(tky, aes(colour=cut(`p adj`, c(0, 0.01, 0.05, 1), 
                           label=c("p<0.01","p < 0.05","Non-Sig")))) +
  geom_hline(yintercept=0, lty="11", colour="grey30") +
  geom_errorbar(aes(pair, ymin=lwr, ymax=upr), width=0.2) +
  geom_point(aes(pair, diff)) +
  labs(colour="") + ylab("Difference") + xlab("Pair") + Theme_experimental + theme(legend.background = element_rect(fill = "#2c5c8b")) + coord_flip()
```




Final Results {data-navmenu="Main Research" data-orientation=columns}
=========================================================================================
  
Column {.tabset}
-------------------------------------------
  
  
### Gold-MSI and Class
<i>Here we will interpret the graphs</i>


### STOMP and Class
Interpretation will follow, also add why we didn't include other graphs (Nikita will know)



Column {.tabset}
-------------------------------------------
  
  
### Gold-MSI and Class
```{r}
my_data <- read.csv2("CLASSGOLDMSI.csv")
p1 <- ggplot(my_data, aes(x= reorder(CLASSS, GOLD.MSI.SCORE, fun = median), y= GOLD.MSI.SCORE, group=CLASSS, fill=CLASSS)) + 
  geom_boxplot(fill = c("pink", "lightgreen", "lightblue"), size=0.6, outlier.size = NA, coef = 0) +
  theme_bw() +
  theme(axis.line = element_line(colour = "black"),
        panel.grid.major = element_blank(),
        panel.grid.minor = element_blank(),
        panel.border = element_blank(),
        panel.background = element_blank(),
        plot.backgroun = element_rect(fill = "#2c5c8b")) + 
  xlab("Class") + ylab("Gold-MSI Score") + 
  theme(legend.position="none", 
        axis.text.x = element_text(colour = "white"),
        axis.title.x = element_text(colour = "white"),
        axis.ticks.x = element_line(colour = "white"),
        axis.ticks.y = element_line(colour = "white"),
        axis.title.y = element_text(colour = "white"),
        axis.text.y = element_text(colour = "white")) + 
scale_x_discrete(labels = c('Dislikers','Indifferents','Likers'))
ggplotly(p1)
```

### STOMP and Class
```{r}
Stomp_Classes <- read.csv("D:/STUDIE/PSYCH/JAAR 3/HONOURS MUSICOLOGY/Portfolio/Stomp_Classes.csv", sep=";")

data <- subset(Stomp_Classes, STOMP1!= "#N/B")

d2 <- data %>% 
  group_by(Classes,STOMP1) %>% 
  summarise(count=n()) %>% 
  mutate(perc=count/sum(count))


d2$STOMP1 <- factor(d2$STOMP1, levels = c("Intense & Rebellious", "Reflective&Complex", "Energetic & Rhythmic", "Upbeat & Conventional", "#N/B"), labels = c("Intense & Rebellious", "Reflective & Complex", "Energetic & Rhythmic", "Upbeat & Conventional", "#N/B"))


ggplot(d2, aes(x = STOMP1, y = perc, fill = Classes)) +
  geom_bar(stat = "identity", position = "dodge") + 
  Theme_experimental + 
  theme(legend.background = element_rect(fill = "#2c5c8b"),
        panel.background = element_rect(fill = "#CCE5FF"),
        panel.grid.major.x = element_blank(),
        axis.text.x = element_text(size=8, angle = 45, hjust = 1)) +
  ylab("Percentage") + 
  scale_y_continuous(labels=scales::percent)
                                                                                
```

  
Conclusion and Discussion {data-navmenu="Main Research" data-orientation=columns}
===============================================================================
  
  Column
-------------------------------------
  
  
### Conclusion
  <i>Here we will interpret the graphs</i>
  
Column
-------------------------------------



### Discussion
  <i>Here we will visualize some Gender, STOMP-scores, Gold-MSI and other types of class characteristics that are interesting in a tabset form</i>

  
  
  



