---
title:  'Beauty in the Ear of the Beholder '
output: 
    flexdashboard::flex_dashboard:
        css: mytheme.css
        vertical_layout: scroll
        orientation: rows
---

```{r setup}
# In order to use these packages, we need to install flexdashboard, plotly, and Cairo.
library(tidyverse)
library(plotly)
library(spotifyr)
library(Cairo)
library(gridExtra)
library(grid)
library(gtable)
library(ggplot2)
library(compmus)
library(viridis)
library(DT)
source('spotify.R')

```

Intro
====================================

Row
-------------------------------------

### Assessing the beauty of music
Music is valued by people primarily for its aesthetics, be it because of the emotion it is capable of generating, the memories it triggers, or the beauty it transcends. Nevertheless, this perception of aesthetics is highly subjective. There is no specific reason or explanation to why one would for example prefer jazz over pop music. This realisation has however not stopped scholars and academics from generating theories that objectifies aesthetics. The modernist theory which contends that artistic music is less popularly valued because of its high intellectual demand serves as an example. This theory would explain the above-mentioned example by arguing that jazz music is less popularly valued because of its complex form and is therefore a genre that can be comprehended only by musically sophisticated individuals. With these ongoing debates in the arena, we wanted to test if there is an objective quality to beauty. This led us to our research question: “To what extent does musical sophistication influence the perception of beauty”. 

To answer our research question, we will operationalise musical sophistication and beauty by using the Goldsmiths Musical Sophistication Index and Qualtrics to make an online survey.
We first made a selection of 15 songs that we deemed as most awe-inspiring. We then used the Goldsmiths Musical Sophistication Index to measure musical sophistication and used an online survey to ask participants to assess their experience of beauty. For analysis, we used Latent Class analysis.


Row 
-------------------------------------


### Some other text explaining the structure of the site





### Contact information and Names




Expert Analysis
=========================================
 



Column
-------------------------------------
### Rating the Songs
When starting out our survey, we searched online for known datasets that included musical pieces that were dissected on their musical components. This was important as we wanted to compare musical sophistication with musical pieces and we needed information about the structure of these pieces. Since this yielded no results, we decided to each supply 5 instrumental songs to a playlist on Spotify. These songs needed to be instrumental to control for the influence of language on the perception of beauty. After we compiled 30 songs, we then used 3 musical experts with more than 10 years of formal training to rate them on 9 components on a 10-point Likert-scale, copying the method used in the article of Aljanaki et al. (<a href="https://www.researchgate.net/publication/267326664_COMPUTATIONAL_MODELING_OF_INDUCED_EMOTION_USING_GEMS">2016</a>). The following components were:

- Tempo: the general pulse of the song, ranging from very slow (1) to very fast (10)

- Articulation: The rhythmic articulation of each song, ranging from very staccato (1) to completely legato (10), staccato are separate notes with rests in between, legato notes are notes that are strung together.

- Mode: overall mode and feel of the songs, ranging from minor (1) to major (10)

- Intensity: overall loudness and crescendos and decrescendos in a song, ranging from 1 (pianissimo) to 10 (fortissimo)

- Tonalness: overall tonalness of the composition, ranging from (1) atonal, with no discernable mode or key to tonal (10) with no use of "outside" extensions and very clear discernable key and mode

- Pitch: overall distribution of the pitches, ranging from all bass (1) to all treble (10)

- Melody: overall presence and dominance of melody, ranging from very unmelodious (1) to very melodious (10)

- Rhythmic Clarity: overall presence of a pulse, ranging from very vague (1) to very firm (10)

- Rhythmic Complexity: the extent to which different meters, odd tempo's or complex rhytmic patterns are utilized, ranging from very simple (1) to very complex (10)

You can see the distribution of the scores over 30 songs in the boxplot on the right.

Looking at the distribution, it becomes apparent that the components Articulation, Mode and Rhythmic Clarity are pretty well distributed, judging by the interquartile range (these are the coloured bodies representing the 25th and 75th percentile range of the assigned values), but nearly all components seem to cover a broad spectrum. Exceptions are the components Pitch and Melody, with Pitch mostly being rated between 4 and 8, indicating a slight preference for more treble within our selection and melody ranges between 5 and 9, indicating a slight preferences for pieces with a clear melody. Both have outliers in the lower ranges  however, which could be used for the eventual selection as well to cover as much of the spectrum as possible.

After rating all 30 songs, we wanted to select 15 songs for our final survey. These songs had to be reliable in expert rating and cover most of the range of the 9 components.


### Boxplot of the components of all 30 songs

```{r}
Features30 <- read.csv2("Features30.csv")
Features_wide <- Features30 %>%
  gather("Tempo", "Articulation", "Mode", "Intensity", "Tonalness", "Pitch", "Melody", "Rhytmic.Clarity", "Rhythmic.Complexity", key = Feature, value = Parameter)

ggplot(Features_wide, aes(x = Feature, y = Parameter, fill = Feature)) +
  geom_boxplot(show.legend = FALSE, alpha = 0.75) +
    theme(text = element_text(),
        axis.text.x = element_text(size=7, angle = 45, hjust = 1))
   

```

Column
-------------------------------------

### Assessing reliability
To start our selection of 15 songs, we first estimated the reliability of the expert ratings per song. To do this we computed distance scores between each of the 3 experts. For example, each rater provided a rating of the component Tempo for a given song. The first rater gave it a 5, the second rater gave it a 6 and the third a 7. The distance could then be calculated by taking the distance between the first and the second rater (6 - 5 = 1), the distance between the second and the third rater (7 - 6 = 1) and the distance between the first and the third rater (7 - 5 = 2). We then summed the difference (1 + 1 + 2 = 4), which provided an estimate of rater consensus on the component tempo.

Subsequently, this was done for all components per song, and then all the reliability scores per component were summed to give an estimate of overall reliability. The table on the right shows these scores for all 30 songs.

As can be seen from the table, the reliability scores range between 26 and 64, with a lower score representing better consensus on that song. Based on these scores, we estimated a cut-off point for song selection (reliability score < 45), and used this to select our songs. Upon examining our prior selection however, it became apparent that the distribution of tempo ratings was skewed to favour higher tempos and not enough atonal songs (low score on tonalness). To correct for this we decided to swap the song Sesiu Nata Drama (reliability score of 46) of the song The Kiss (reliability score of 42), to make sure our songs represented most of the component ranges. In the next segment we will examine this further.



### Reliability scores per song
```{r}
Rela <- read.csv("Reliability.csv", sep=";")

datatable(Rela,
  rownames = FALSE, options = list(pageLength = 15)
)
```


Column
-------------------------------------

### Re-examing the components of our song selection
To re-examine our selection of songs, we've now used a jitterplot instead of a boxplot, since 15 songs are not enough to compute proper boxplots. By using jittering, we can make sure that the points do not overlap per feature, but instead jitter slightly to the left and right of the vertical line that can be drawn from the x-axis per component. 

Examing the jitterplot, it becomes apparent that our selection covers quite a large range for most components, with a range of around 6 for most components. Certain interest should be given towards the component of Pitch, which features mostly average Bass/Treble compositions, with 1 lower range song.

Overall this looks to be an okay distribution of songs, given that the playlist was compiled by 6 different people with different preferences. For some components however, a more extreme rating would be preferred so we would've had more room to examine the eventual class differences. 







### The jitterplot shows our song selection more clearly
```{r}
Features15 <- read.csv("Features_goed.csv", sep=";")

Features15_wide <- Features15 %>%
  gather("Tempo", "Articulation", "Mode", "Intensity", "Tonalness", "Pitch", "Melody", "Rhytmic.Clarity", "Rhythmic.Complexity", key = Feature, value = Parameter)


jitter <- ggplot(Features15_wide, aes(x = Feature, y = Parameter, col = Feature, label = Song)) +
  geom_jitter(width = 0.25, alpha = 0.5) +
    theme(axis.text.x = element_text(size=7, angle = 45, hjust = 1)) +
  scale_y_continuous(limits = c(0, 10), breaks = seq(0,10, by = 1))

ggplotly(jitter)



```


Column
-------------------------------------

### Concluding the expert analysis
So far, the distribution of song components looks good, and we've done the best we can to select the most reliable songs for our survey. What remains now is to get to construct our questionnaire and sample our participants. To finish things off, we've included all our selected songs in full for you to listen to and assess whether our selection comprises the entire range yourself. Do you agree with our selection? The final selected snippets for the questionnaire are in the tab Song Snippets.



### Our selected songs
<br>
<iframe src="https://open.spotify.com/embed/playlist/10OqKYDJG7e4fEBZDCzcvw" width="300" height="800" frameborder="0" allowtransparency="true" allow="encrypted-media"></iframe>





Song Snippets
========================================

Row
-------------------------------------

###  Songs 

Blueming<br>
<audio controls>
  <source src="Blueming.mp3" type="audio/mpeg"> 
</audio> <br>


Bygone Bumps <br>
<audio controls>
  <source src="Bygone Bumps.mp3" type="audio/mpeg">
</audio>  <br>


Cia Pat <br>
<audio controls>
  <source src="Cia Pat.mp3" type="audio/mpeg">
</audio>  <br>

Decision (Price of Love)<br>
<audio controls>
  <source src="Decision (Price of Love).mp3" type="audio/mpeg"> 
</audio> <br>


Elysium <br>
<audio controls>
  <source src="Elysium.mp3" type="audio/mpeg">
</audio>  <br>



Firth Of Fifth <br>
<audio controls>
  <source src="Firth Of Fifth.mp3" type="audio/mpeg">
</audio>  <br>

Less Is Moi <br>
<audio controls>
  <source src="Less Is Moi.mp3" type="audio/mpeg">
</audio>  <br>

Married Life <br>
<audio controls>
  <source src="Married Life.mp3" type="audio/mpeg">
</audio>  <br>

Resolver <br>
<audio controls>
  <source src="Resolver.mp3" type="audio/mpeg">
</audio>  <br>

Scarface Theme <br>
<audio controls>
  <source src="ScarFace 'Tony Theme' Giorgio Moroder.mp3" type="audio/mpeg">
</audio>  <br>


Single Petal Of A Rose <br>
<audio controls>
  <source src="Single Petal Of A Rose.mp3" type="audio/mpeg">
</audio>  <br>

Song For A New Beginning <br>
<audio controls>
  <source src="Song For A New Beginning.mp3" type="audio/mpeg">
</audio>  <br>

syro u473t8+e <br>
<audio controls>
  <source src="syro u473t8+e [141.98] (piezoluminescence mix).mp3" type="audio/mpeg">
</audio>  <br>

Šešių Natų Drama _ Drama In Six Notes <br>
<audio controls>
  <source src="Šešių Natų Drama _ Drama In Six Notes.mp3" type="audio/mpeg">
</audio>  <br>

USA III Rail <br>
<audio controls>
  <source src="USA III Rail.mp3" type="audio/mpeg">
</audio>  <br>








